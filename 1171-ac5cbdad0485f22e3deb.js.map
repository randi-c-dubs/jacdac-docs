{"version":3,"file":"1171-ac5cbdad0485f22e3deb.js","mappings":"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","sources":["webpack://jacdac-docs/./node_modules/@material-ui/icons/VolumeDown.js","webpack://jacdac-docs/./node_modules/@material-ui/icons/VolumeUp.js","webpack://jacdac-docs/./src/components/dashboard/DashboardBuzzer.tsx"],"sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M18.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM5 9v6h4l5 5V4L9 9H5z\"\n}), 'VolumeDown');\n\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\n\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z\"\n}), 'VolumeUp');\n\nexports.default = _default;","import { Grid, Slider } from \"@material-ui/core\"\nimport React, { lazy, useContext, useEffect } from \"react\"\nimport { BuzzerCmd, BuzzerReg } from \"../../../jacdac-ts/src/jdom/constants\"\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\"\nimport { jdpack } from \"../../../jacdac-ts/src/jdom/pack\"\nimport { useRegisterUnpackedValue } from \"../../jacdac/useRegisterValue\"\nimport useServiceServer from \"../hooks/useServiceServer\"\nimport BuzzerServer from \"../../../jacdac-ts/src/servers/buzzerserver\"\nimport VolumeDownIcon from \"@material-ui/icons/VolumeDown\"\nimport Suspense from \"../ui/Suspense\"\nimport useRegister from \"../hooks/useRegister\"\nimport { Alert } from \"@material-ui/lab\"\nimport { IconButton } from \"gatsby-theme-material-ui\"\nimport VolumeUpIcon from \"@material-ui/icons/VolumeUp\"\nimport WebAudioContext from \"../ui/WebAudioContext\"\nconst PianoWidget = lazy(() => import(\"../widgets/PianoWidget\"))\n\nexport default function DashboardBuzzer(props: DashboardServiceProps) {\n    const { service } = props\n    const server = useServiceServer<BuzzerServer>(service)\n    const color = server ? \"secondary\" : \"primary\"\n    const volumeRegister = useRegister(service, BuzzerReg.Volume)\n    const [volume] = useRegisterUnpackedValue<[number]>(volumeRegister, props)\n    const { playTone, onClickActivateAudioContext, activated } =\n        useContext(WebAudioContext)\n\n    // listen for playTone commands from the buzzer\n    useEffect(\n        () =>\n            server?.subscribe<{\n                frequency: number\n                duration: number\n                volume: number\n            }>(BuzzerServer.PLAY_TONE, ({ frequency, duration, volume }) =>\n                playTone?.(frequency, duration, volume)\n            ),\n        [server]\n    )\n\n    const sendPlayTone = async (f: number) => {\n        if (server) onClickActivateAudioContext() // enable audio context within click handler\n        const vol = 1\n        const period = 1000000 / f\n        const duty = (period * vol) / 2\n        const duration = 400\n        const data = jdpack<[number, number, number]>(\"u16 u16 u16\", [\n            period,\n            duty,\n            duration,\n        ])\n        await service.sendCmdAsync(BuzzerCmd.PlayTone, data)\n    }\n    const handleChange = async (ev: unknown, newValue: number | number[]) => {\n        volumeRegister.sendSetPackedAsync(\"u0.8\", [newValue], true)\n    }\n    const handleUnlock = () => sendPlayTone(400)\n\n    return (\n        <>\n            {server && !activated && (\n                <Grid item xs>\n                    <Alert severity=\"warning\">\n                        Click to activate sounds. &nbsp;\n                        <IconButton\n                            aria-label=\"unlock sounds\"\n                            onClick={handleUnlock}\n                        >\n                            <VolumeUpIcon />\n                        </IconButton>\n                    </Alert>\n                </Grid>\n            )}\n            <Grid item xs aria-hidden={true}>\n                <Suspense>\n                    <PianoWidget playTone={sendPlayTone} />\n                </Suspense>\n            </Grid>\n            {volume !== undefined && (\n                <Grid item xs={12}>\n                    <Grid container spacing={2}>\n                        <Grid item>\n                            <VolumeDownIcon color=\"disabled\" />\n                        </Grid>\n                        <Grid item xs>\n                            <Slider\n                                valueLabelDisplay=\"off\"\n                                min={0}\n                                max={1}\n                                step={0.1}\n                                aria-label=\"volume\"\n                                value={volume}\n                                color={color}\n                                onChange={handleChange}\n                            />\n                        </Grid>\n                        <Grid item>\n                            <VolumeUpIcon color=\"disabled\" />\n                        </Grid>\n                    </Grid>\n                </Grid>\n            )}\n        </>\n    )\n}\n"],"names":["Grid","Slider","React","lazy","useContext","useEffect","BuzzerCmd","BuzzerReg","jdpack","useRegisterUnpackedValue","useServiceServer","BuzzerServer","VolumeDownIcon","Suspense","useRegister","Alert","IconButton","VolumeUpIcon","WebAudioContext","PianoWidget","DashboardBuzzer","props","service","server","color","volumeRegister","Volume","volume","playTone","onClickActivateAudioContext","activated","subscribe","PLAY_TONE","frequency","duration","sendPlayTone","f","vol","period","duty","data","sendCmdAsync","PlayTone","handleChange","ev","newValue","sendSetPackedAsync","handleUnlock","undefined"],"sourceRoot":""}