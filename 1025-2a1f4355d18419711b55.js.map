{"version":3,"file":"1025-2a1f4355d18419711b55.js","mappings":"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","sources":["webpack://jacdac-docs/./src/components/dashboard/DashboardCompass.tsx"],"sourcesContent":["import React from \"react\"\nimport { DashboardServiceProps } from \"./DashboardServiceWidget\"\nimport {\n    useRegisterBoolValue,\n    useRegisterUnpackedValue,\n} from \"../../jacdac/useRegisterValue\"\nimport SvgWidget from \"../widgets/SvgWidget\"\nimport useWidgetTheme from \"../widgets/useWidgetTheme\"\nimport useServiceServer from \"../hooks/useServiceServer\"\nimport { Grid, Slider } from \"@material-ui/core\"\nimport SensorServer from \"../../../jacdac-ts/src/servers/sensorserver\"\nimport {\n    CompassReg,\n    SystemStatusCodes,\n} from \"../../../jacdac-ts/src/jdom/constants\"\nimport PowerButton from \"../widgets/PowerButton\"\nimport LoadingProgress from \"../ui/LoadingProgress\"\nimport useRegister from \"../hooks/useRegister\"\n\nexport default function DashboardCompass(props: DashboardServiceProps) {\n    const { service } = props\n\n    const headingRegister = useRegister(service, CompassReg.Heading)\n    const enabledRegister = useRegister(service, CompassReg.Enabled)\n    const [heading] = useRegisterUnpackedValue<[number]>(headingRegister, props)\n    const enabled = useRegisterBoolValue(enabledRegister, props)\n    const [status] = useRegisterUnpackedValue<[SystemStatusCodes, number]>(\n        service.statusCodeRegister,\n        props\n    )\n    const off = !enabled\n\n    const server = useServiceServer<SensorServer<[number]>>(service)\n    const color = server ? \"secondary\" : \"primary\"\n    const { background, controlBackground, active, textProps } =\n        useWidgetTheme(color)\n\n    if (heading === undefined) return <LoadingProgress />\n\n    const calibrating = status === SystemStatusCodes.Calibrating\n\n    const w = 64\n    const h = 64\n    const mw = 5\n    const r = (w >> 1) - 4\n    const sw = 3\n    const cx = w >> 1\n    const cy = h >> 1\n    const sp = 1\n    const pr = 5\n    const pri = 3\n\n    const handleChange = async (ev: unknown, newValue: number | number[]) => {\n        await server?.reading.setValues([newValue as number])\n        headingRegister.refresh()\n    }\n    const valueDisplay = (angle: number) => `${Math.round(angle)}Â°`\n    const toggleOff = () => enabledRegister.sendSetBoolAsync(off, true)\n\n    return (\n        <Grid container direction=\"column\">\n            <Grid item xs={12}>\n                <SvgWidget width={w} height={h}>\n                    <circle\n                        cx={cx}\n                        cy={cy}\n                        r={r}\n                        fill={controlBackground}\n                        stroke={background}\n                        strokeWidth={sw}\n                    />\n                    <g\n                        transform={`rotate(${off ? 0 : heading}, ${w >> 1}, ${\n                            h >> 1\n                        })`}\n                    >\n                        <path\n                            d={`M ${cx - mw} ${\n                                cy + sp / 2\n                            } l ${mw} ${r} l ${mw} ${-r} z`}\n                            fill={background}\n                            stroke={background}\n                            strokeWidth={sp}\n                        />\n                        <path\n                            d={`M ${cx - mw} ${\n                                cy - sp / 2\n                            } l ${mw} ${-r} l ${mw} ${r} z`}\n                            stroke={background}\n                            fill={off ? controlBackground : active}\n                            strokeWidth={sp}\n                        />\n                    </g>\n                    {calibrating && (\n                        <circle\n                            cx={cx}\n                            cy={cy}\n                            r={r}\n                            opacity={0.9}\n                            fill={background}\n                        />\n                    )}\n                    {calibrating && (\n                        <text x={cx} y={cy} fontSize={8} {...textProps}>\n                            calibrating\n                        </text>\n                    )}\n                    <PowerButton\n                        r={pr}\n                        ri={pri}\n                        cx={w - pr - 1}\n                        cy={h - pr - 1}\n                        color={color}\n                        strokeWidth={1}\n                        off={off}\n                        onClick={toggleOff}\n                    />\n                </SvgWidget>\n            </Grid>\n            {server && (\n                <Grid item>\n                    <Slider\n                        color={color}\n                        valueLabelDisplay=\"auto\"\n                        valueLabelFormat={valueDisplay}\n                        min={0}\n                        max={360}\n                        step={1}\n                        value={heading}\n                        onChange={handleChange}\n                        aria-label=\"heading\"\n                    />\n                </Grid>\n            )}\n        </Grid>\n    )\n}\n"],"names":["React","useRegisterBoolValue","useRegisterUnpackedValue","SvgWidget","useWidgetTheme","useServiceServer","Grid","Slider","CompassReg","SystemStatusCodes","PowerButton","LoadingProgress","useRegister","DashboardCompass","props","service","headingRegister","Heading","enabledRegister","Enabled","heading","enabled","status","statusCodeRegister","off","server","color","background","controlBackground","active","textProps","undefined","calibrating","Calibrating","w","h","mw","r","sw","cx","cy","sp","pr","pri","handleChange","ev","newValue","reading","setValues","refresh","valueDisplay","angle","Math","round","toggleOff","sendSetBoolAsync"],"sourceRoot":""}